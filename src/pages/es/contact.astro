---
import Layout from '@/layouts/PageLayout.astro';
import AuthorQuery from '@/graphql/AuthorQuery';
import { wpquery } from '@/data/wordpress';
import Button from '@/components/ui/Button.astro';
import type Author from '@/interfaces/Author';
import Form from '@/components/ui/Form.astro';
import { fetchAuthor } from '@/utils/author';
import { I18N } from '@/utils/config';
import { getLangFromUrl } from '@/i18n/utils';

const metadata = {
  title: "Contacto | Alex Srebernic",
  ignoreTitleTemplate: true,
};
const lang = getLangFromUrl(Astro.url.pathname)
const { email,phonenumber } : Author = await fetchAuthor(lang as string)
const inputs = [
  {
    type: 'text',
    placeholder: 'Name',
    name: 'Name'
  },
  {
    type: 'email',
    placeholder: 'Email',
    name: 'Email'
  },
]
const textarea = {
  placeholder:'Message'
}
---

<Layout metadata={metadata}>
  <section class="border-b py-5 dark:border-b-[#424242]">
    <div class="space-y-4 font-[600]">
      <h1 class="text-3xl font-[600] ">
        Contacto
      </h1>
      <p class="text-sm font-[400] text-subtitle">
        PÃ³ngase en contacto para consultas sobre desarrollo web      
      </p>
    </div>
  </section>
  <section >
    <div class="flex space-y-4 md:space-y-0 md:flex-row md:items-center justify-between py-8 flex-col items-start">
      <div class="flex-1">
        <p class="text-[#111111] ">
          {email}
        </p>
        <p class="text-xs text-subtitle">
          Correo electronico
        </p>
      </div>
      <div class="flex-1">
        <p class="text-[#111111]">
          {phonenumber}
        </p>
        <p class="text-xs text-subtitle">
          Numero de telefono
        </p>
      </div>
    </div>
    <div>
      <Button href="/about"  variant="primary" text="Agendar una llamada" />
      <Button id="copyEmailButton" type="button" icon="copy" variant="secondary" text="Copiar Email"/>
    </div>
  </section>
  <section data-aos="fade-up" class="py-10 space-y-6">
    <h2 class="text-2xl font-[500]">Enviar mensaje</h2>
    <Form inputs={inputs} textarea={textarea}/>
  </section>
</Layout>
<script define:vars={{email, lang}} >
  const button = document.getElementById('copyEmailButton')
  function copyEmailToClipboard() {
    navigator.clipboard.writeText(email);
    const oldText = button.innerHTML
    button.innerHTML =  `Copiado! <svg class="w-4 h-4 ml-1 -mr-1.5 rtl:mr-1 rtl:-ml-1.5 inline-block" xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24">
	<rect width="24" height="24" fill="none" />
	<path fill="currentColor" d="M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z" />
</svg>`
    setTimeout(() => {
      button.innerHTML = oldText
    }, 1500);
  }
  button.addEventListener('click', copyEmailToClipboard)
</script>
